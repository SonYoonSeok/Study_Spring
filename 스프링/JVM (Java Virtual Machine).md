# JVM (Java Virtual Machine)

> 자바 프로그램을 동작시키는 머신, 자바의 클래스 파일들은 운영체제에서 직접 동작하는 것이 아니라 JVM위에서 동작한다.

## JVM의 구성

![img](https://t1.daumcdn.net/cfile/tistory/99F6923F5B7585CF34)

* 클래스 로더 (Class Loader) : 클래스 파일들을 로드하고, 각각 런타임 영역에 배치한다.
* 런타임 데이터 영역 (Runtime Data Areas) : 클래스 파일의 데이터를 메모리 영역에 구분하여 저장한다. (스태틱 힙, 스택, PC 레지스터, 네이티브 메서드 스택)
* 실행 엔진 (Execution Engine) : 런타임 데이터 영역에 배치된 바이트코드를 해석하여 실행한다.  인터프리터 방식과 JIT 컴파일 방식을 혼합해 사용한다.
  * 인터프리터 방식 : 바이트 코드를 한 줄씩 해석한다.
  * JIT 컴파일 방식 : 바이트 코드를 런타임 시점에 바로 기계어로 반환한다.
* 가비지 컬렉터 (Garbage Collector) : 사용되지 않는 객체를 해제시켜 메모리를 자동으로 반납한다.



## 자바의 메모리 영역

|            메모리영역            | 용도                                                         | 보존기간                                  | 스레드 공유        |
| :------------------------------: | ------------------------------------------------------------ | ----------------------------------------- | ------------------ |
| 메서드<br />=클래스<br />=스태틱 | 클래스 로더에 의해 로딩된 **클래스, 메서드, 클래스 변수, 전역 변수**가 저장된다. | 프로그램의 시작부터 종료까지 남는다.      | 모든 스레드에 공유 |
|                힙                | 참조형 데이터타입, new 연산자를 통해 생성된 객체가 저장되는 공간이다. | 객체가 더 이상 안쓰일 때 까지 남는다.     | 모든 스레드에 공유 |
|               스택               | 기본형 데이터타입, 지역변수, 매개변수, 리턴값, 참조변수 등이 저장된다.<br />FILO 방식으로 생성, LIFO으로 제거 | {} 또는 메서드가 끝날 때까지              | 각 스레드별로 생성 |
|           PC 레지스터            | JVM이 수행할 명령어의 주소를 저장하는 공간                   | 스레드가 시작될 때마다 생성               | 각 스레드별로 생성 |
|       네이티브 메서드 스택       | 기계어로 작성된 코드를 실행하는 공간<br />다른 언어로 작성된 코드를 수행 | Java Native Interface 호출 및 종료시 생성 | 각 스레드별로 생성 |

